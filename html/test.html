<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>test</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- <link rel="stylesheet" type="text/css" media="screen" href="main.css" />
  <script src="main.js"></script> -->
  <script src="//cdn.bootcss.com/jquery/1.11.3/jquery.min.js"></script>
</head>

<body>
  <input type="text" placeholder="用户名" id="username">
  <select name="" id="banklist">
    <option value="999999-NGUYEN HONG NHUNG">NGUYEN HONG NHUNG</option>
    <option value="99001-Agribank">Agribank</option>
    <option value="99002-Saigonbank">Saigonbank</option>
    <option value="99003-PG Bank">PG Bank</option>
    <option value="99004-GP Bank">GP Bank</option>
    <option value="99005-Sacombank">Sacombank</option>
    <option value="99006-Nam Á Bank">Nam Á Bank</option>
    <option value="99007-Đông Á bank">Đông Á bank</option>
    <option value="99008-Vietinbank">Vietinbank</option>
    <option value="99009-Techcombank">Techcombank</option>
    <option value="99010-VIB">VIB</option>
    <option value="99011-HDBank">HDBank</option>
    <option value="99012-Eximbank">Eximbank</option>
    <option value="99013-TienphongBank">TienphongBank</option>
    <option value="99014-Maritime Bank">Maritime Bank</option>
    <option value="99015-BIDV">BIDV</option>
    <option value="99016-MB">MB</option>
    <option value="99017-Seabank">Seabank</option>
    <option value="99018-SHB">SHB</option>
    <option value="99019-Việt Á Bank">Việt Á Bank</option>
    <option value="99020-OceanBank">OceanBank</option>
    <option value="99021-Vietcombank">Vietcombank</option>
    <option value="99022-VP Bank">VP Bank</option>
    <option value="99023-ACB">ACB</option>
    <option value="99027-NaviBank">NaviBank</option>
    <option value="99026-Bắc á">Bắc á</option>
    <option value="99029-AnBinhBank">AnBinhBank</option>
    <option value="99030-Dai a bank">Dai a bank</option>
    <option value="99031-Visa - Master">Visa - Master</option>
    <option value="99032-PVcombank">PVcombank</option>
    <option value="99033-Liên Việt posbank">Liên Việt posbank</option>
    <option value="99034-Bảo Việt Bank">Bảo Việt Bank</option>
    <option value="99035-Ngân hàng Phương Đông Việt Nam (OCB)">Ngân hàng Phương Đông Việt Nam (OCB)</option>
    <option value="99036-Kiên Long Bank">Kiên Long Bank</option>
    <option value="99037-Ngân hàng Quốc dân (NCB)">Ngân hàng Quốc dân (NCB)</option>
    <option value="99038-Ngân hàng liên doanh Việt Nga (VRB)">Ngân hàng liên doanh Việt Nga (VRB)</option>
    <option value="99039-NH TNHH MTV Public Vietnam">NH TNHH MTV Public Vietnam</option>
  </select>
  <button type="submit" id="submit">提交</button>
  <script>
    // const htmlStr = 'https://www.buyoo.vn/html/addOnItemdetails.html?brandId=139&masterId=112';
    const htmlStr = 'https://www.buyoo.vn/html/addOnItemdetails/139-112.html';
    const quarter_regexp = /addOnItemdetails\/([^]+?)-([^]+?)\.html/;
    const result = htmlStr.match(quarter_regexp);
    console.log(result);
  </script>
  <script>
    var hrefUtils = (function (loc) {
      var utils = {
        convertQs: function (qs) {
          var qs = qs || loc.search.substring(1);
          if (!qs) return null;
          var qsArr = qs.split(/&/),
            qsPar = {};
          for (var i = 0; i < qsArr.length; i++) {
            if (qsArr[i]) {
              var nm = qsArr[i].split(/=/);
              qsPar[decodeURIComponent(nm[0])] = decodeURIComponent(nm[1] || "");
            }
          }
          return qsPar;
        }
      };

      function parse(url) {
        var i;
        var url = url || loc.href;
        var regExp = /^(?:([A-Za-z]+):)?(\/{0,3})([0-9.\-A-Za-z]+)(?::(\d+))?(?:\/([^?#]*))?(?:\?([^#]*))?(?:#(.*))?$/;
        var names = ["url", "scheme", "slash", "host", "port", "path", "query", "hash"];
        var result = regExp.exec(url);
        var result_format = {};

        for (i = 0; i < names.length; i += 1) {
          result_format[names[i]] = result[i];
        }
        result_format.query = utils.convertQs(result_format.query);

        return result_format;
      }

      return {
        parse: parse
      };
    })(location);


    function edit_url() {
      function joint_url(url, object) {

        for (const key in object) {
          if (object.hasOwnProperty(key)) {
            if (key !== 'url') {
              url += '&' + key + '=' + object[key];
            }
          }
        }
        return url;
      }

      var query = hrefUtils.parse().query;
      // console.log(query);
      var url_base = query.url;
      // console.log(url_base);

      var val = $('#banklist').val().split('-');
      var username = $("#username").val();

      if (url_base.indexOf('?') === -1) {
        url_base += '?bankID=' + val[0] + '&userName=' + username;
      } else {
        url_base += '&bankID=' + val[0] + '&userName=' + username;
      }

      return joint_url(url_base, query);
    }

    $('#submit').on('click', function () {
      if ($("#username").val().length === 0) {
        alert("请输入用户名");
        return false;
      }
      window.open(edit_url());
      // console.log(edit_url());
      // $.ajax({
      //   type: "GET",
      //   url: edit_url(),
      //   success: function (ret) {
      //     ret = JSON.parse(ret);

      //   },
      //   error: function (ret) {
      //     console.error("request error");
      //   }
      // });
    });
  </script>
</body>

</html>